<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lakshay Handa: Rise of the Data Scientist</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%);
            color: #00ff88;
            overflow-x: hidden;
            cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><rect fill="%2300ff88" width="3" height="3" x="8" y="8"/><rect fill="%23ffffff" width="1" height="1" x="9" y="9"/></svg>'), auto;
            image-rendering: pixelated;
            min-height: 100vh;
            transition: background 5s ease;
        }
        
        body.day-mode {
            background: linear-gradient(135deg, #3a8bd6 0%, #5ebbf5 50%, #87ceeb 100%);
            color: #006644;
        }
        
        body.sunset-mode {
            background: linear-gradient(135deg, #ff7e00 0%, #ff9e40 50%, #ffbf80 100%);
            color: #004433;
        }
        
        .day-night-cycle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ffcc00;
            box-shadow: 0 0 20px rgba(255, 204, 0, 0.8);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.5s ease;
        }
        
        .day-night-cycle.night {
            background: #aaaaff;
            box-shadow: 0 0 20px rgba(170, 170, 255, 0.8);
        }
        
        .day-night-cycle.sunset {
            background: #ff7700;
            box-shadow: 0 0 20px rgba(255, 119, 0, 0.8);
        }
        
        .crt-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            background: 
                linear-gradient(transparent 50%, rgba(0, 255, 136, 0.02) 51%),
                radial-gradient(ellipse at center, transparent 70%, rgba(0, 0, 0, 0.3) 100%);
            background-size: 100% 4px, 100% 100%;
            animation: crtFlicker 0.15s linear infinite;
        }
        
        @keyframes crtFlicker {
            0% { opacity: 1; }
            97% { opacity: 1; }
            98% { opacity: 0.97; }
            99% { opacity: 0.99; }
            100% { opacity: 1; }
        }
        
        .game-container {
            min-height: 100vh;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent 0px,
                    rgba(0, 255, 136, 0.03) 1px,
                    transparent 2px
                ),
                radial-gradient(circle at 30% 20%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(0, 191, 255, 0.1) 0%, transparent 50%);
            position: relative;
            padding: 20px;
        }
        
        .particle-system {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00ff88;
            animation: float 8s infinite linear;
            opacity: 0.6;
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-20px) translateX(100px); opacity: 0; }
        }
        
        .hud {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 999;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.95), rgba(0, 34, 0, 0.9));
            border: 4px solid #00ff88;
            padding: 20px;
            font-size: 12px;
            line-height: 20px;
            box-shadow: 
                0 0 30px rgba(0, 255, 136, 0.6),
                inset 0 0 20px rgba(138, 43, 226, 0.3);
            min-width: 220px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        
        .level-display {
            color: #ffff00;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: levelGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes levelGlow {
            from { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8); }
            to { text-shadow: 2px 2px 8px rgba(255, 255, 0, 0.6), 0 0 10px rgba(255, 255, 0, 0.4); }
        }
        
        .health-bar, .xp-bar {
            width: 170px;
            height: 12px;
            background: linear-gradient(145deg, #330033, #220022);
            border: 3px solid #00ff88;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
            border-radius: 6px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #00bfff, #00ff88, #ffff00);
            width: 0%;
            transition: width 0.8s ease;
            position: relative;
            animation: xpShimmer 2s ease-in-out infinite;
        }
        
        @keyframes xpShimmer {
            0%, 100% { box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.2); }
            50% { box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.4); }
        }
        
        .action-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .rpg-button {
            background: linear-gradient(145deg, #4169e1, #2f4f4f);
            border: 3px solid #00ff88;
            padding: 15px 25px;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            color: #ffffff;
            cursor: pointer;
            box-shadow: 
                0 6px 0 #004444,
                0 0 20px rgba(0, 255, 136, 0.4);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }
        
        .rpg-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }
        
        .rpg-button:hover {
            background: linear-gradient(145deg, #5a7fff, #3f6f6f);
            transform: translateY(-4px) scale(1.05);
            box-shadow: 
                0 10px 0 #004444,
                0 0 30px rgba(0, 255, 136, 0.6);
        }
        
        .rpg-button:hover::before {
            left: 100%;
        }
        
        .rpg-button:active {
            transform: translateY(2px) scale(0.98);
            box-shadow: 
                0 4px 0 #004444,
                0 0 15px rgba(0, 255, 136, 0.3);
        }
        
        .title-screen {
            text-align: center;
            padding: 50px;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.95), rgba(0, 34, 0, 0.8));
            border: 6px solid;
            border-image: linear-gradient(45deg, #00ff88, #8a2be2, #00bfff, #00ff88) 1;
            margin: 40px auto;
            max-width: 950px;
            box-shadow: 
                0 0 40px rgba(0, 255, 136, 0.5),
                inset 0 0 40px rgba(138, 43, 226, 0.3);
            position: relative;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .main-title {
            font-size: 36px;
            color: #ffff00;
            margin-bottom: 25px;
            text-shadow: 
                4px 4px 0px #ff6600,
                8px 8px 15px rgba(0, 0, 0, 0.8);
            animation: titlePulse 3s infinite alternate;
            letter-spacing: 6px;
        }
        
        @keyframes titlePulse {
            from { 
                color: #ffff00; 
                text-shadow: 4px 4px 0px #ff6600, 8px 8px 15px rgba(0, 0, 0, 0.8);
                transform: scale(1);
            }
            to { 
                color: #ff6600; 
                text-shadow: 4px 4px 0px #ffff00, 8px 8px 25px rgba(255, 255, 0, 0.6);
                transform: scale(1.02);
            }
        }
        
        .subtitle {
            font-size: 18px;
            margin-bottom: 30px;
            color: #00ff88;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            animation: subtitleGlow 4s ease-in-out infinite alternate;
        }
        
        @keyframes subtitleGlow {
            from { color: #00ff88; }
            to { color: #00bfff; text-shadow: 3px 3px 6px rgba(0, 191, 255, 0.5); }
        }
        
        .game-instructions {
            font-size: 11px;
            color: #cccccc;
            margin-top: 25px;
            line-height: 18px;
            text-align: left;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(0, 17, 0, 0.6));
            padding: 20px;
            border: 3px solid #004444;
            border-radius: 10px;
            box-shadow: inset 0 0 15px rgba(0, 255, 136, 0.2);
        }
        
        .game-world {
            position: relative;
            width: calc(100% - 40px);
            height: 450px;
            background: 
                linear-gradient(180deg, #4169e1 0%, #228b22 35%, #8b4513 100%),
                repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    rgba(0, 0, 0, 0.1) 20px,
                    transparent 40px
                );
            border: 6px solid #00ff88;
            margin: 40px auto;
            max-width: 1400px;
            overflow: hidden;
            box-shadow: 
                0 0 40px rgba(0, 255, 136, 0.4),
                inset 0 0 60px rgba(0, 0, 0, 0.4);
            position: relative;
            border-radius: 12px;
        }
        
        .parallax-bg {
            position: absolute;
            width: 120%;
            height: 120%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 255, 0, 0.15) 5%, transparent 15%),
                radial-gradient(circle at 80% 40%, rgba(255, 255, 255, 0.1) 3%, transparent 10%),
                radial-gradient(circle at 40% 80%, rgba(0, 255, 255, 0.15) 4%, transparent 12%),
                radial-gradient(circle at 60% 60%, rgba(138, 43, 226, 0.1) 6%, transparent 20%);
            animation: parallaxFloat 25s infinite linear;
        }
        
        @keyframes parallaxFloat {
            from { transform: translate(-10%, -10%) rotate(0deg); }
            to { transform: translate(10%, 10%) rotate(360deg); }
        }
        
        .ground-track {
            position: absolute;
            bottom: 80px;
            left: 60px;
            right: 60px;
            height: 15px;
            background: 
                linear-gradient(90deg, #8b4513, #cd853f, #8b4513),
                repeating-linear-gradient(
                    90deg,
                    #654321 0px,
                    #654321 12px,
                    #8b4513 12px,
                    #8b4513 24px
                );
            border: 3px solid #654321;
            box-shadow: 
                0 6px 0 #4a2c17,
                inset 0 0 15px rgba(0, 0, 0, 0.4);
            border-radius: 4px;
        }
        
        /* CUSTOM SPRITE CHARACTER STYLES */
        .character {
            position: absolute;
            bottom: 95px;
            left: 60px;
            width: 48px;
            height: 48px;
            z-index: 500;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            image-rendering: pixelated;
            filter: drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.6));
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }
        
        /* Character Sprites - Directly from the image */
        .character.sprite1 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABYklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIDNZoMY4yRtGyVAjBGr1QoAsFwuJxNhcAEppYcjhDBZPwYXkFLCcrnEYrHAcrnEarWaRITBBYQQcDgccL1eAQCHwwEhhMHbNbiAbdueHgDYbrej9GNwAefzGefzGQBwuVxwuVxG6cfgAi6XC87nM0IIiDHier2O0o9RHmQxxsHzjyLAzPDeP/3mnINzrjdvbwHMDGYGEYGZ4b3vzRtEQP7RnJn7JO5NbwHOORARmBnMDCJ6yl1KiZQSUkrNvEEE5FFnZjjnmvLVCGgdcW/+vADfAFaV7Fah++BdAAAAAElFTkSuQmCC');
        }
        
        .character.sprite2 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWElEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.sprite3 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.sprite4 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
            animation: energyPulse 1.5s ease-in-out infinite alternate;
        }
        
        .character.sprite5 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.sprite6 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.sprite7 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.sprite8 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
            animation: energyPulse 1.5s ease-in-out infinite alternate;
        }
        
        .character.sprite9 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .character.walking {
            animation: characterWalk 0.6s ease-in-out infinite;
        }
        
        @keyframes energyPulse {
            0% { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7)) brightness(1); }
            100% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.9)) brightness(1.2); }
        }
        
        @keyframes characterWalk {
            0%, 100% { transform: translateY(0) scaleY(1); }
            50% { transform: translateY(-8px) scaleY(0.95); }
        }
        
        @keyframes characterJump {
            0% { transform: translateY(0) scaleY(1); }
            40% { transform: translateY(-60px) scaleY(0.9); }
            70% { transform: translateY(-70px) scaleY(0.9); }
            100% { transform: translateY(0) scaleY(1.1); }
        }
        
        .character.jumping {
            animation: characterJump 0.8s cubic-bezier(0.5, 0, 0.5, 1);
        }
        
        .character.level-up {
            animation: levelUpGlow 2.5s ease-in-out;
        }
        
        /* Platform elements */
        .platform {
            position: absolute;
            background: linear-gradient(to bottom, #00aa44, #008833);
            border-top: 4px solid #00cc55;
            border-left: 2px solid #00cc55;
            border-right: 2px solid #006622;
            border-bottom: 4px solid #006622;
            height: 20px;
            z-index: 300;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }
        
        .platform.moving {
            animation: platformMove 8s infinite alternate linear;
        }
        
        @keyframes platformMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(200px); }
        }
        
        /* Obstacles */
        .obstacle {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #aa0000, #880000);
            border-radius: 5px;
            z-index: 350;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            animation: obstacleGlow 2s infinite alternate;
        }
        
        @keyframes obstacleGlow {
            0% { box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
            100% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.8); }
        }
        
        /* Power-ups */
        .power-up {
            position: absolute;
            width: 25px;
            height: 25px;
            border-radius: 5px;
            z-index: 350;
            animation: powerUpFloat 2s infinite alternate ease-in-out;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.7);
        }
        
        .power-up.speed {
            background: linear-gradient(135deg, #00ffff, #0088ff);
            border: 2px solid #00ccff;
        }
        
        .power-up.jump {
            background: linear-gradient(135deg, #ff00ff, #8800ff);
            border: 2px solid #cc00ff;
        }
        
        .power-up.shield {
            background: linear-gradient(135deg, #ffff00, #ff8800);
            border: 2px solid #ffcc00;
        }
        
        @keyframes powerUpFloat {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-10px) rotate(10deg); }
        }
        
        /* Character jumping animation */
        .character.jumping {
            animation: characterJump 0.5s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            z-index: 600;
        }
        
        @keyframes characterJump {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-50px) scale(0.95); }
            100% { transform: translateY(0) scale(1); }
        }
        
        @keyframes levelUpGlow {
            0% { 
                filter: drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.6)); 
                transform: scale(1);
            }
            50% { 
                filter: 
                    drop-shadow(0 0 25px rgba(255, 255, 0, 0.9))
                    drop-shadow(0 0 50px rgba(255, 255, 0, 0.5))
                    drop-shadow(0 0 75px rgba(255, 215, 0, 0.3)); 
                transform: scale(1.3);
            }
            100% { 
                filter: drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.6)); 
                transform: scale(1);
            }
        }
        
        /* Platform Elements */
        .platform {
            position: absolute;
            height: 20px;
            background: linear-gradient(to bottom, #00aa44 0%, #008833 100%);
            border-top: 4px solid #00cc55;
            border-bottom: 4px solid #006622;
            z-index: 300;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .platform::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 0;
            right: 0;
            height: 4px;
            background: repeating-linear-gradient(to right, #00cc55, #00cc55 10px, #00dd66 10px, #00dd66 20px);
        }
        
        .platform.floating {
            animation: platformFloat 3s ease-in-out infinite;
        }
        
        @keyframes platformFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Obstacles */
        .obstacle {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #aa0000 0%, #880000 100%);
            border: 3px solid #cc0000;
            border-radius: 50%;
            z-index: 350;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            animation: obstacleGlow 2s ease-in-out infinite;
        }
        
        @keyframes obstacleGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 0, 0, 0.5); }
            50% { box-shadow: 0 0 25px rgba(255, 0, 0, 0.8); }
        }
        
        /* Power-ups */
        .power-up {
            position: absolute;
            width: 25px;
            height: 25px;
            border-radius: 5px;
            z-index: 400;
            cursor: pointer;
            animation: powerUpFloat 2s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(100, 200, 255, 0.7);
        }
        
        .power-up.speed {
            background: linear-gradient(135deg, #00ccff 0%, #0088cc 100%);
            border: 2px solid #00aaff;
        }
        
        .power-up.jump {
            background: linear-gradient(135deg, #88ff00 0%, #66cc00 100%);
            border: 2px solid #aaff00;
        }
        
        .power-up.shield {
            background: linear-gradient(135deg, #cc00ff 0%, #8800cc 100%);
            border: 2px solid #dd00ff;
        }
        
        @keyframes powerUpFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(180deg); }
        }
        
        .character.moving {
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .xp-coin {
            position: absolute;
            bottom: 120px;
            width: 28px;
            height: 28px;
            background: 
                radial-gradient(circle at 35% 35%, #ffff80, #ffff00, #ffd700);
            border: 3px solid #ffaa00;
            border-radius: 50%;
            cursor: pointer;
            z-index: 400;
            animation: coinFloat 2.5s ease-in-out infinite;
            box-shadow: 
                0 0 20px rgba(255, 215, 0, 0.7),
                inset 0 0 15px rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            color: #000;
        }
        
        .xp-coin::before {
            content: '$';
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        @keyframes coinFloat {
            0%, 100% { transform: translateY(0) rotateY(0deg) scale(1); }
            25% { transform: translateY(-15px) rotateY(90deg) scale(1.1); }
            50% { transform: translateY(-20px) rotateY(180deg) scale(1.05); }
            75% { transform: translateY(-15px) rotateY(270deg) scale(1.1); }
        }
        
        .xp-coin.collected {
            animation: coinCollect 1s ease-in-out forwards;
        }
        
        @keyframes coinCollect {
            0% { transform: scale(1) rotateY(0deg); opacity: 1; }
            30% { transform: scale(1.6) rotateY(180deg); opacity: 0.9; }
            60% { transform: scale(1.2) rotateY(360deg) translateY(-30px); opacity: 0.6; }
            100% { transform: scale(0) rotateY(540deg) translateY(-60px); opacity: 0; }
        }
        
        .world-map-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 17, 0, 0.9));
            backdrop-filter: blur(15px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.6s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.6s ease;
        }
        
        .modal-content {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(10, 30, 20, 0.95));
            border: 2px solid #00ff88;
            border-radius: 10px;
            width: 80%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
            position: relative;
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 2px solid #00ff88;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            margin: 0;
            color: #00ff88;
            font-size: 20px;
        }
        
        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
            color: #00ff88;
        }
        
        /* Achievement System Styles */
        .achievements-modal-content {
            max-width: 600px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(10, 30, 20, 0.95));
        }
        
        .achievement-badge {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .achievement-badge.locked {
            filter: grayscale(1);
            opacity: 0.5;
        }
        
        .achievement-badge.common {
            border-color: #aaaaaa;
        }
        
        .achievement-badge.rare {
            border-color: #00aaff;
        }
        
        .achievement-badge.epic {
            border-color: #aa00ff;
        }
        
        .achievement-badge.legendary {
            border-color: #ffaa00;
            box-shadow: 0 0 15px rgba(255, 170, 0, 0.5);
        }
        
        .achievement-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .achievement-icon.common {
            background: linear-gradient(135deg, #cccccc, #888888);
        }
        
        .achievement-icon.rare {
            background: linear-gradient(135deg, #00ccff, #0088aa);
        }
        
        .achievement-icon.epic {
            background: linear-gradient(135deg, #cc00ff, #8800aa);
        }
        
        .achievement-icon.legendary {
            background: linear-gradient(135deg, #ffcc00, #ff8800);
            animation: legendaryGlow 2s infinite alternate;
        }
        
        @keyframes legendaryGlow {
            0% { box-shadow: 0 0 5px rgba(255, 170, 0, 0.7); }
            100% { box-shadow: 0 0 15px rgba(255, 170, 0, 1); }
        }
        
        .achievement-details {
            flex: 1;
        }
        
        .achievement-title {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .achievement-description {
            font-size: 12px;
            color: #aaaaaa;
            margin-bottom: 5px;
        }
        
        .achievement-progress {
            font-size: 10px;
            color: #00ff88;
        }
        
        .achievement-progress-bar {
            height: 5px;
            background: rgba(0, 255, 136, 0.2);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .achievement-progress-fill {
            height: 100%;
            background: #00ff88;
            width: 0%;
            transition: width 1s ease;
        }
        
        .achievement-popup {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ffcc00;
            border-radius: 10px;
            padding: 15px;
            z-index: 1000;
            width: 250px;
            box-shadow: 0 0 20px rgba(255, 204, 0, 0.5);
            animation: achievementPopup 0.5s ease-out;
            transform-origin: bottom right;
            display: none;
        }
        
        @keyframes achievementPopup {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .world-map-content {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.95), rgba(0, 34, 0, 0.8));
            border: 6px solid #00ff88;
            padding: 40px;
            max-width: 1300px;
            max-height: 90vh;
            width: 95%;
            overflow-y: auto;
            box-shadow: 
                0 0 50px rgba(0, 255, 136, 0.5),
                inset 0 0 50px rgba(138, 43, 226, 0.3);
            position: relative;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(145deg, #ff0040, #cc0033);
            border: 3px solid #ffffff;
            width: 40px;
            height: 40px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            box-shadow: 0 4px 0 #990022;
            transition: all 0.3s;
        }
        .close-button:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 7px 0 #990022;
        }
        .close-button:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 #990022;
        }
        
        .world-map-title {
            text-align: center;
            font-size: 24px;
            color: #ffff00;
            margin-bottom: 40px;
            text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.8);
            animation: titleShimmer 3s ease-in-out infinite alternate;
        }
        
        @keyframes titleShimmer {
            from { color: #ffff00; }
            to { color: #ffd700; text-shadow: 4px 4px 8px rgba(255, 215, 0, 0.6); }
        }
        
        .regions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 25px;
        }
        
        .region {
            background: linear-gradient(145deg, rgba(0, 17, 0, 0.9), rgba(0, 34, 0, 0.7));
            border: 4px solid #00ff88;
            padding: 25px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .region::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .region:hover {
            border-color: #ffff00;
            transform: translateY(-6px) scale(1.02);
            box-shadow: 
                0 12px 25px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(255, 255, 0, 0.3);
        }
        
        .region:hover::before {
            left: 100%;
        }
        
        .region-title {
            font-size: 14px;
            color: #ffff00;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        .region-icon {
            font-size: 32px;
            margin-bottom: 20px;
            display: block;
            text-align: center;
            animation: iconBob 2s ease-in-out infinite;
        }
        
        @keyframes iconBob {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .region-description {
            font-size: 9px;
            line-height: 14px;
            color: #cccccc;
        }
        
        .region.viewed {
            border-color: #00bfff;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.6);
            background: linear-gradient(145deg, rgba(0, 17, 34, 0.9), rgba(0, 34, 68, 0.7));
        }

        .chatbot {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 380px;
            height: 450px;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.95), rgba(0, 17, 0, 0.9));
            border: 4px solid #00ff88;
            z-index: 1500;
            display: flex;
            flex-direction: column;
            border-radius: 12px;
            overflow: hidden;
            transition: height 0.4s ease-out;
            box-shadow: 
                0 0 30px rgba(0, 255, 136, 0.4),
                inset 0 0 20px rgba(138, 43, 226, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .chatbot.minimized {
            height: 60px;
        }
        
        .chatbot-header {
            background: linear-gradient(145deg, #00ff88, #00cc66);
            color: #000000;
            padding: 15px;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-size: 9px;
            line-height: 14px;
            background: linear-gradient(145deg, rgba(0, 17, 0, 0.6), rgba(0, 34, 0, 0.4));
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .chatbot-messages::-webkit-scrollbar {
            display: none;
        }
        
        .chatbot-input {
            display: flex;
            padding: 15px;
            border-top: 3px solid #00ff88;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(0, 17, 0, 0.8));
        }
        
        .chatbot-input input {
            flex: 1;
            background: linear-gradient(145deg, rgba(0, 17, 0, 0.9), rgba(0, 34, 0, 0.7));
            border: 3px solid #00ff88;
            padding: 10px;
            color: #00ff88;
            font-family: 'Press Start 2P', monospace;
            font-size: 9px;
            border-radius: 6px;
            outline: none;
            transition: all 0.3s;
        }
        
        .chatbot-input input:focus {
            border-color: #ffff00;
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.4);
        }
        
        .chatbot-input button {
            background: linear-gradient(145deg, #00ff88, #00cc66);
            color: #000000;
            border: 3px solid #00ff88;
            padding: 10px 15px;
            margin-left: 10px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 9px;
            border-radius: 6px;
            box-shadow: 0 3px 0 #006633;
            transition: all 0.2s;
        }
        .chatbot-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 0 #006633;
        }
        .chatbot-input button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 0 #006633;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 8px;
            max-width: 90%;
            animation: messageSlideIn 0.4s ease-out;
        }
        
        @keyframes messageSlideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .user-message {
            background: linear-gradient(145deg, rgba(0, 100, 255, 0.3), rgba(0, 150, 255, 0.2));
            border: 2px solid #0066ff;
            margin-left: auto;
            text-align: right;
            color: #66aaff;
            box-shadow: 0 0 10px rgba(0, 102, 255, 0.3);
        }
        
        .bot-message {
            background: linear-gradient(145deg, rgba(0, 255, 136, 0.3), rgba(0, 200, 136, 0.2));
            border: 2px solid #00ff88;
            margin-right: auto;
            color: #88ffaa;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        
        .level-up-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10000;
            background: linear-gradient(145deg, #ffff00, #ffd700);
            color: #000000;
            padding: 40px 60px;
            border: 6px solid #ff6600;
            font-size: 18px;
            animation: levelUpNotification 3s ease forwards;
            pointer-events: none;
            text-align: center;
            border-radius: 12px;
            display: none;
            box-shadow: 
                0 0 40px rgba(255, 215, 0, 0.8),
                inset 0 0 20px rgba(255, 255, 255, 0.3);
        }
        
        @keyframes levelUpNotification {
            0% { transform: translate(-50%, -50%) scale(0) rotate(-180deg); opacity: 0; }
            20% { transform: translate(-50%, -50%) scale(1.4) rotate(0deg); opacity: 1; }
            40% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0) rotate(180deg); opacity: 0; }
        }
        
        .progress-stats {
            text-align: center;
            padding: 30px;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.9), rgba(0, 17, 0, 0.8));
            border: 4px solid #00ff88;
            margin: 30px auto;
            max-width: 900px;
            border-radius: 12px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 25px;
            box-shadow: 
                0 0 30px rgba(0, 255, 136, 0.4),
                inset 0 0 30px rgba(138, 43, 226, 0.2);
        }
        
        .stat {
            padding: 20px;
            background: linear-gradient(145deg, rgba(0, 17, 0, 0.8), rgba(0, 34, 0, 0.6));
            border: 3px solid #004444;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .stat:hover {
            border-color: #00ff88;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .stat:hover::before {
            left: 100%;
        }
        
        .stat-value {
            font-size: 24px;
            color: #ffff00;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: statPulse 2s ease-in-out infinite alternate;
        }
        
        @keyframes statPulse {
            from { color: #ffff00; }
            to { color: #ffd700; text-shadow: 2px 2px 4px rgba(255, 215, 0, 0.6); }
        }
        
        .stat-label {
            font-size: 9px;
            color: #00ff88;
        }

        /* Enhanced Mobile Optimizations */
        @media (max-width: 768px) {
            .main-title { font-size: 24px; letter-spacing: 3px; }
            .subtitle { font-size: 14px; }
            .game-world { height: 350px; margin: 25px 10px; }
            .character { width: 40px; height: 40px; bottom: 85px; left: 40px; }
            .xp-coin { width: 24px; height: 24px; bottom: 110px; font-size: 12px; }
            .chatbot { 
                width: 95%; 
                height: 350px; 
                right: 2.5%; 
                bottom: 15px;
                left: 2.5%;
            }
            .hud { 
                position: static; 
                margin: 15px auto; 
                width: 95%; 
                box-sizing: border-box;
                min-width: unset;
            }
            .action-buttons { 
                position: static; 
                margin: 15px auto; 
                flex-direction: row; 
                justify-content: center; 
                gap: 10px;
                flex-wrap: wrap;
            }
            .rpg-button {
                padding: 12px 18px;
                font-size: 9px;
            }
            .regions-grid { grid-template-columns: 1fr; gap: 20px; }
            .world-map-content { padding: 25px; }
            .world-map-title { font-size: 18px; }
            .region { padding: 20px; }
            .region-icon { font-size: 28px; }
        }
        
        /* Enhanced Visual Effects */
        .glow-pulse {
            animation: glowPulse 2s ease-in-out infinite alternate;
        }
        
        @keyframes glowPulse {
            from { box-shadow: 0 0 10px rgba(0, 255, 136, 0.3); }
            to { box-shadow: 0 0 25px rgba(0, 255, 136, 0.8); }
        }
        
        .floating-text {
            position: absolute;
            pointer-events: none;
            font-size: 12px;
            font-weight: bold;
            color: #ffff00;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: floatText 2s ease-out forwards;
            z-index: 600;
        }
        
        @keyframes floatText {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-40px) scale(1.2); opacity: 0; }
        }
        
        /* Sound control panel */
        .sound-controls {
            position: fixed;
            bottom: 25px;
            left: 25px;
            z-index: 999;
            display: flex;
            gap: 10px;
        }
        
        .sound-button {
            background: linear-gradient(145deg, #333333, #222222);
            border: 2px solid #00ff88;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.4);
        }
        
        .sound-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
        }
        
        .sound-button.active {
            background: linear-gradient(145deg, #00ff88, #00cc66);
            border-color: #ffffff;
        }
        
        .sound-icon {
            font-size: 18px;
            color: #ffffff;
        }
        
        /* Sprite selection panel */
        /* Mini-map */
        .mini-map {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 150px;
            height: 100px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff88;
            border-radius: 5px;
            z-index: 900;
            padding: 5px;
            display: flex;
            flex-direction: column;
        }
        
        .mini-map-title {
            font-size: 8px;
            text-align: center;
            margin-bottom: 5px;
            color: #00ff88;
        }
        
        .mini-map-content {
            flex: 1;
            position: relative;
            background: rgba(0, 40, 20, 0.5);
            border: 1px solid #00aa55;
        }
        
        .mini-map-player {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #00ff88;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .mini-map-coin {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffff00;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .mini-map-platform {
            position: absolute;
            height: 2px;
            background: #00aa55;
            transform: translateY(-50%);
        }
        
        .mini-map-obstacle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ff0000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .mini-map-toggle {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 10px;
            height: 10px;
            background: #00ff88;
            border-radius: 50%;
            cursor: pointer;
            font-size: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
        }
        
        .sprite-selector {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(0, 17, 0, 0.7));
            padding: 15px;
            border-radius: 15px;
            border: 3px solid #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
        }
        
        .sprite-selector-title {
            color: #ffff00;
            font-size: 10px;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
        }
        
        .sprite-options {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .sprite-option {
            width: 40px;
            height: 40px;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }
        
        .sprite-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);
        }
        
        .sprite-option.selected {
            border-color: #ffff00;
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.6);
        }
        
        .sprite-option.sprite-1 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABYklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .sprite-option.sprite-2 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWElEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .sprite-option.sprite-3 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
        }
        
        .sprite-option.sprite-4 {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABWklEQVRoge2ZMW7DMAxFP4Neq1foETxmzZG6d+iWI3j00CN0zZojZM8ROmfpGTJ0CQokQGrLlmxRlPIeYMQSxc8fS7YlIaWUcEeYuwEjcwrwKcDcDRiZU4BPAeZuwMicAnwKMHcDRuYU4FOAuRswMqcAnwLM3YCR+f8FiAh2ux0AYL/fQ0QmadgoAWKMWK/XAIBPZsQYJ2nbKAFijFitVgCAxXKJGOMkIgwuIKX0cIQQJuvH4AJSSliulljMF1guV1itVpOIMLiAEAIOhwOu1ysA4HA4IIQweFsGF7Bdrk6PANguV6P0Y3AB5/MZ5/MZAHDJLrhcLqP0Y3ABl8sF5/MZIQTEGHFNr6P0Y5QHWYxx8PyjCDAzvPdPv3POPeWt5e0tgJnBzCAiMDO8971ZgwjIP5pzrk/i3vQW4JwDEYGZwcwgoqfcpZRIKSGl1MwaREB+1ZkZzrlm3hoBrSPuzZ8X4BvXZOyVXHzgdQAAAABJRU5ErkJggg==');
            animation: energyPulse 1.5s ease-in-out infinite alternate;
        }
        
        .sprite-label {
            position: absolute;
            bottom: -20px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 8px;
            color: #00ff88;
        }
        
        /* Game controls help */
        .game-controls-help {
            position: fixed;
            bottom: 25px;
            right: 420px;
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(0, 17, 0, 0.7));
            border: 3px solid #00ff88;
            border-radius: 12px;
            padding: 15px;
            font-size: 10px;
            color: #00ff88;
            max-width: 200px;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
            z-index: 999;
            animation: helpPulse 3s ease-in-out infinite alternate;
        }
        
        @keyframes helpPulse {
            0% { box-shadow: 0 0 10px rgba(0, 255, 136, 0.3); }
            100% { box-shadow: 0 0 25px rgba(0, 255, 136, 0.7); }
        }
        
        .game-controls-help h3 {
            color: #ffff00;
            font-size: 12px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .game-controls-help ul {
            list-style-type: none;
            padding: 0;
        }
        
        .game-controls-help li {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .game-controls-help .key {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
            border-radius: 4px;
            padding: 2px 5px;
            margin-right: 8px;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="crt-overlay"></div>
    <div class="particle-system" id="particleSystem"></div>
    
    <div class="game-container">
        <!-- Day/Night Cycle Toggle -->
        <div class="day-night-cycle" id="dayNightToggle" onclick="toggleDayNightCycle()"></div>
        
        <!-- Mini-Map -->
        <div class="mini-map" id="miniMap">
            <div class="mini-map-title">MINI-MAP</div>
            <div class="mini-map-content" id="miniMapContent"></div>
            <div class="mini-map-toggle" onclick="toggleMiniMap()"></div>
        </div>
        
        <!-- Enhanced HUD -->
        <div class="hud glow-pulse">
            <div class="level-display">LVL <span id="level">1</span> DATA SCIENTIST</div>
            <div>XP: <span id="coinsCollected">0</span>/<span id="xpToNextLevel">2000</span></div>
            <div class="xp-bar">
                <div class="xp-fill" id="xpFill"></div>
            </div>
            <div style="margin-top: 10px; font-size: 8px; color: #888;">
                COINS COLLECTED: <span id="totalCoinsCollected" style="color: #ffd700;">0</span>
            </div>
        </div>
        
        <!-- Enhanced Action Buttons -->
        <div class="action-buttons">
            <button class="rpg-button" onclick="openWorldMap()"> INFO MAP</button>
            <button class="rpg-button" onclick="toggleChatbot()"> AI CHAT</button>
            <button class="rpg-button" onclick="openAchievements()"> ACHIEVEMENTS</button>
            <button class="rpg-button" onclick="resetGame()"> RESET</button>
        </div>
        
        <!-- Enhanced Title Screen -->
        <div class="title-screen">
            <h1 class="main-title">LAKSHAY HANDA</h1>
            <h2 class="subtitle">RISE OF THE DATA SCIENTIST</h2>
            <div class="game-instructions">
                > ENHANCED CONTROLS:<br>
                > CLICK COINS TO COLLECT THEM<br>
                > CHARACTER MOVES TO CLICKED COINS<br>
                > ACCESS INFO MAP FOR DETAILED PROFILE<br>
                > CHAT WITH AI BOT FOR QUESTIONS<br>
                > COLLECT ALL COINS TO UNLOCK FINAL FORM<br>
                > CUSTOM SOUND EFFECTS & ANIMATIONS<br>
                <br>
                > 16-BIT RPG EXPERIENCE WITH SPRITE ANIMATIONS
            </div>
        </div>
        
        <!-- Enhanced Game World -->
        <div class="game-world" id="gameWorld">
            <div class="parallax-bg"></div>
            <div class="ground-track"></div>
            <div class="character sprite1" id="character"></div> 
        </div>
        
        <!-- Enhanced Progress Stats -->
        <div class="progress-stats">
            <div class="stat">
                <div class="stat-value" id="totalRegions">7</div>
                <div class="stat-label">INFO REGIONS</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="viewedRegions">0</div>
                <div class="stat-label">VIEWED</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="currentLevel">1</div>
                <div class="stat-label">CURRENT LVL</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="totalCoinsCollectedStat">0</div>
                <div class="stat-label">COINS FOUND</div>
            </div>
        </div>
        
        <!-- Enhanced World Map Modal -->
        <div class="world-map-modal" id="worldMapModal">
            <div class="world-map-content">
                <button class="close-button" onclick="closeWorldMap()"></button>
                <h2 class="world-map-title">LAKSHAY'S DATA UNIVERSE</h2>
                
                <div class="regions-grid" id="regionsGrid">
                    <!-- Regions will be dynamically loaded here by JS -->
                </div>
            </div>
        </div>

        <!-- Enhanced Chatbot -->
        <div class="chatbot" id="chatbot">
            <div class="chatbot-header" onclick="toggleChatbot()">
                <span> AI ASSISTANT v2.0</span>
                <span id="chatbotToggleIcon">_</span>
            </div>
            <div class="chatbot-messages" id="chatbotMessages">
                <div class="message bot-message"> Greetings, adventurer! Ask me anything about Lakshay's epic data journey. Try asking about his skills, projects, or experience!</div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatInput" placeholder="Type your epic query...">
                <button onclick="sendMessage()">SEND</button>
            </div>
        </div>

        <!-- Enhanced Level Up Notification -->
        <div class="level-up-notification" id="levelUpNotification">
            LEVEL UP! <span id="leveledUpTo"></span>
        </div>
        
        <!-- Achievement System Modal -->
        <div class="modal" id="achievementsModal">
            <div class="modal-content achievements-modal-content">
                <div class="modal-header">
                    <h2> ACHIEVEMENTS</h2>
                    <span class="close-button" onclick="closeAchievementsModal()"></span>
                </div>
                <div class="modal-body" id="achievementsList">
                    <!-- Achievements will be dynamically added here -->
                </div>
            </div>
        </div>
        
        <!-- Achievement Popup -->
        <div class="achievement-popup" id="achievementPopup" style="display: none;">
            <div class="achievement-popup-header">
                <div class="achievement-popup-icon"></div>
                <div class="achievement-popup-title">Achievement Unlocked!</div>
            </div>
            <div class="achievement-popup-description" id="achievementPopupDescription">
                You've unlocked a new achievement!
            </div>
            <div class="achievement-popup-reward" id="achievementPopupReward">
                Reward: +500 XP
            </div>
        </div>
        
        <!-- Sound Controls -->
        <div class="sound-controls">
            <div class="sound-button active" id="soundToggle" onclick="toggleSound()">
                <span class="sound-icon"></span>
            </div>
            <div class="sound-button active" id="musicToggle" onclick="toggleMusic()">
                <span class="sound-icon"></span>
            </div>
        </div>
        
        <!-- Sprite Selector -->
        <div class="sprite-selector">
            <div class="sprite-selector-title">CHOOSE YOUR SPRITE</div>
            <div class="sprite-options">
                <div class="sprite-option sprite-1 selected" onclick="changeSprite('sprite1')">
                    <div class="sprite-label">NORMAL</div>
                </div>
                <div class="sprite-option sprite-2" onclick="changeSprite('sprite2')">
                    <div class="sprite-label">WALK</div>
                </div>
                <div class="sprite-option sprite-3" onclick="changeSprite('sprite3')">
                    <div class="sprite-label">CHECK</div>
                </div>
                <div class="sprite-option sprite-4" onclick="changeSprite('sprite4')">
                    <div class="sprite-label">ENERGY</div>
                </div>
            </div>
        </div>
        
        <!-- Game Controls Help -->
        <div class="game-controls-help">
            <h3>HOW TO PLAY</h3>
            <ul>
                <li><span class="key"></span> Click coins to collect</li>
                <li><span class="key"></span> Change sprite appearance</li>
                <li><span class="key"></span> Toggle sound effects</li>
                <li><span class="key"></span> Toggle background music</li>
                <li><span class="key"></span> Open info map to learn more</li>
            </ul>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <script>
        // Enhanced Game with Character Movement and Custom Audio
        (async () => {
            // --- Global Constants & Game State Variables ---
            const player = {
                level: 1,
                xp: 0,
                viewedRegions: new Set(),
                totalCoinsCollected: 0,
                position: { x: 60, y: 95 }, // Character position
                selectedSprite: 'sprite1',
                isJumping: false,
                jumpVelocity: 0,
                platformsJumped: 0,
                powerUps: {
                    speed: false,
                    jump: false,
                    shield: false
                },
                inventory: []
            };

            const gameSettings = {
                maxCoins: 4,
                coinSpawnInterval: 4000,
                xpPerCoin: 300,
                characterSpeed: 0.5, // seconds to move to coin (faster for Mario-like movement)
                xpLevels: {
                    1: 0,
                    2: 2000,
                    3: 5000,
                    4: 9000,
                    5: 14000,
                    6: 20000,
                },
                soundEnabled: true,
                musicEnabled: true,
                gravity: 0.5,      // Gravity force for jumping
                jumpPower: 12,     // Initial jump velocity
                platformSpeed: 1.5, // Speed of moving platforms
                maxPlatforms: 3,   // Maximum number of platforms
                maxObstacles: 2,   // Maximum number of obstacles
                maxPowerUps: 1     // Maximum number of power-ups
            };

            const xpCoins = [];
            let coinSpawnTimer;
            let isMoving = false;
            let targetCoin = null;
            let walkAnimationFrame = 1;
            let walkAnimationInterval;

            // --- DOM Elements ---
            const levelDisplay = document.getElementById('level');
            const coinsCollectedDisplay = document.getElementById('coinsCollected');
            const xpToNextLevelDisplay = document.getElementById('xpToNextLevel');
            const xpFill = document.getElementById('xpFill');
            const characterElement = document.getElementById('character');
            const gameWorld = document.getElementById('gameWorld');
            const worldMapModal = document.getElementById('worldMapModal');
            const regionsGrid = document.getElementById('regionsGrid');
            const viewedRegionsStat = document.getElementById('viewedRegions');
            const currentLevelStat = document.getElementById('currentLevel');
            const totalRegionsStat = document.getElementById('totalRegions');
            const totalCoinsCollectedDisplay = document.getElementById('totalCoinsCollected');
            const totalCoinsCollectedStat = document.getElementById('totalCoinsCollectedStat');
            const chatbot = document.getElementById('chatbot');
            const chatbotMessages = document.getElementById('chatbotMessages');
            const chatInput = document.getElementById('chatInput');
            const chatbotToggleIcon = document.getElementById('chatbotToggleIcon');
            const levelUpNotification = document.getElementById('levelUpNotification');
            const leveledUpToDisplay = document.getElementById('leveledUpTo');
            const soundToggle = document.getElementById('soundToggle');
            const musicToggle = document.getElementById('musicToggle');

            // --- Enhanced Region Data ---
            const regionsData = {
                profile: {
                    icon: '',
                    title: 'PROFILE HUB',
                    description: `
                        <strong style="color: #ffff00;">LAKSHAY HANDA</strong><br>
                         PHONE: 9818575939<br>
                         LOCATION: DELHI, INDIA<br>
                         DATA SCIENTIST & AI SPECIALIST<br>
                         STRONG MATHEMATICAL FOUNDATION<br><br>
                         CONNECT: <a href="https://www.linkedin.com/in/lakshayhanda" target="_blank" style="color:#00bfff;">LINKEDIN</a> | <a href="https://github.com/lakshayhanda" target="_blank" style="color:#00bfff;">GITHUB</a> | <a href="mailto:connect.lakshay@outlook.com" style="color:#00bfff;">EMAIL</a>
                    `,
                },
                education: {
                    icon: '',
                    title: 'EDUCATION REALM',
                    description: `
                        <strong style="color: #ffff00;">UNIVERSITY OF DELHI</strong><br>
                         BACHELOR OF COMMERCE (HONS)<br>
                         2023-2026/27<br><br>
                        <strong style="color: #00bfff;">CORE SUBJECTS:</strong><br>
                         BUSINESS STATISTICS & ANALYTICS<br>
                         ADVANCED MATHEMATICS<br>
                         FINANCIAL MODELING<br>
                         DATA SCIENCE APPLICATIONS<br>
                         MACHINE LEARNING FOUNDATIONS
                    `
                },
                skills: {
                    icon: '',
                    title: 'SKILL ARSENAL',
                    description: `
                        <strong style="color: #ffff00;">FRAMEWORKS:</strong><br>
                         NUMPY  PANDAS  SCIKIT-LEARN<br>
                         TENSORFLOW  PLOTLY  STREAMLIT<br><br>
                        <strong style="color: #00bfff;">SPECIALIZATIONS:</strong><br>
                         MACHINE LEARNING  NLP  DEEP LEARNING<br>
                         DATA VISUALIZATION  PREDICTIVE MODELING<br><br>
                        <strong style="color: #ff6600;">TOOLS:</strong><br>
                         PYTHON  C++  JUPYTER  VS CODE<br>
                         GIT  MYSQL  MONGODB  GOOGLE COLAB
                    `
                },
                experience: {
                    icon: '',
                    title: 'EXPERIENCE ZONE',
                    description: `
                        <strong style="color: #ffff00;">DATA SCIENCE INTERN - PRODIGY INFOTECH</strong><br>
                         NOV 2024 - DEC 2024<br>
                          PREDICTIVE ANALYTICS FOR BUSINESS INSIGHTS<br>
                          ADVANCED EDA & DATA PREPROCESSING<br>
                          ML MODEL DEPLOYMENT (92% ACCURACY)<br>
                          SENTIMENT ANALYSIS (74K+ RESPONSES)<br><br>
                        <strong style="color: #00bfff;">OPEN SOURCE CONTRIBUTOR - ASKAGE</strong><br>
                          AI-POWERED TERMINAL CHATBOT DEVELOPMENT<br>
                          AUTHENTICATION & API INTEGRATION<br>
                          USER EXPERIENCE OPTIMIZATION<br><br>
                        <strong style="color: #ff6600;">EVENT COORDINATOR - FRENCH EMBASSY</strong><br>
                         CHOOSE FRANCE TOUR 2023<br>
                          LARGE-SCALE EVENT MANAGEMENT<br>
                          STAKEHOLDER ENGAGEMENT (1000+ ATTENDEES)<br>
                          PROCESS OPTIMIZATION (+25% SATISFACTION)
                    `
                },
                projects_spam: {
                    icon: '',
                    title: 'PROJECT: SMS SPAM CLASSIFIER',
                    description: `
                        <strong style="color: #ffff00;">ADVANCED NLP PROJECT</strong><br><br>
                         PROCESSED 5,572 SMS MESSAGES<br>
                         TF-IDF VECTORIZATION IMPLEMENTATION<br>
                         97% ACCURACY ACHIEVED<br>
                         100% PRECISION USING VOTING CLASSIFIER<br>
                         EXTRATREES + MULTINOMIALNB + RANDOM FOREST<br>
                         DEPLOYED VIA STREAMLIT FOR REAL-TIME DETECTION<br><br>
                        <strong style="color: #00ff88;">TECH STACK:</strong> Python, Scikit-Learn, Streamlit
                    `
                },
                projects_fraud: {
                    icon: '',
                    title: 'PROJECT: FRAUD DETECTION MODEL',
                    description: `
                        <strong style="color: #ffff00;">FINANCIAL SECURITY AI</strong><br><br>
                         ANALYZED 6.2M+ TRANSACTION DATASET<br>
                         MACHINE LEARNING FRAUD DETECTION<br>
                         99.95% ACCURACY ACHIEVED<br>
                         LOGISTIC REGRESSION + DECISION TREE + XGBOOST<br>
                         PRECISION, RECALL & F1-SCORE OPTIMIZATION<br>
                         STREAMLIT DEPLOYMENT FOR REAL-TIME DETECTION<br><br>
                        <strong style="color: #00ff88;">TECH STACK:</strong> Python, XGBoost, Streamlit
                    `
                },
                achievements: {
                    icon: '',
                    title: 'ACHIEVEMENTS HALL',
                    description: `
                        <strong style="color: #ffff00;">EPIC ACCOMPLISHMENTS</strong><br><br>
                         <strong>DATA VISUALIZATION MAESTRO</strong><br>
                         Master of Advanced EDA Techniques<br><br>
                         <strong>MACHINE LEARNING CHAMPION</strong><br>
                         97%+ Accuracy in Multiple Projects<br><br>
                         <strong>OPEN SOURCE WARRIOR</strong><br>
                         Contributing to AI Community<br><br>
                         <strong>EVENT MANAGEMENT PRO</strong><br>
                         Coordinated 1000+ Attendee Events<br><br>
                         <strong>SENTIMENT ANALYSIS EXPERT</strong><br>
                         Processed 74K+ Social Media Responses
                    `
                }
            };

            const achievementMessages = [
                " ACHIEVEMENT: Data Visualization Maestro! (+INSIGHTS)",
                " ACHIEVEMENT: Advanced EDA Complete! (+CLEAN DATA)",
                " ACHIEVEMENT: Decision Tree Deployed! (92% ACCURACY)",
                " ACHIEVEMENT: Sentiment Analysis Master! (74K+ RESPONSES)",
                " ACHIEVEMENT: Auth Token Secured! (+CYBER DEFENSE)",
                " ACHIEVEMENT: New Conversation API! (+LLM MEMORY)",
                " ACHIEVEMENT: User Login Interface! (+ACCESSIBILITY)",
                " ACHIEVEMENT: Open Source Contributor! (+COLLABORATION)",
                " ACHIEVEMENT: Event Management Pro! (+COORDINATION)",
                " ACHIEVEMENT: SMS Spam Classifier! (+REAL-TIME AI)",
                " ACHIEVEMENT: Fraud Detection Model! (+FINANCIAL SECURITY)",
                " ACHIEVEMENT: Portfolio Mastery! (+PRESENTATION SKILLS)",
            ];
            let lastAchievementIndex = -1;

            // --- Enhanced Audio Synths ---
            let coinSynth, levelUpSynth, walkSynth, ambientSynth, backgroundMusic;

            async function setupAudio() {
                try {
                    if (typeof Tone === 'undefined') {
                        console.warn('Tone.js not loaded, audio will be disabled');
                        return;
                    }
                    
                    await Tone.start();
                    console.log("Enhanced AudioContext started");

                    // Coin collection sound - more musical (Super Mario style)
                    coinSynth = new Tone.PolySynth(Tone.Synth, {
                        oscillator: { type: "triangle" },
                        envelope: {
                            attack: 0.001,
                            decay: 0.1,
                            sustain: 0.05,
                            release: 0.1
                        },
                        volume: -5
                    }).toDestination();

                    // Level up sound - triumphant chord progression
                    levelUpSynth = new Tone.PolySynth(Tone.Synth, {
                        oscillator: { type: "sawtooth" },
                        envelope: {
                            attack: 0.02,
                            decay: 0.3,
                            sustain: 0.2,
                            release: 0.8
                        },
                        volume: -3
                    }).toDestination();

                    // Walking sound - subtle steps
                    walkSynth = new Tone.NoiseSynth({
                        noise: { type: "brown" },
                        envelope: {
                            attack: 0.001,
                            decay: 0.05,
                            sustain: 0,
                            release: 0.05
                        },
                        volume: -15
                    }).toDestination();

                    // Ambient background - very subtle
                    ambientSynth = new Tone.AutoFilter({
                        frequency: 0.1,
                        baseFrequency: 200,
                        octaves: 2
                    }).toDestination();

                    const ambientOsc = new Tone.Oscillator({
                        frequency: 55,
                        type: "sine",
                        volume: -25
                    }).connect(ambientSynth);
                    
                    ambientOsc.start();
                    
                    // Background music - 8-bit style
                    const synth = new Tone.PolySynth(Tone.Synth, {
                        oscillator: { type: "square" },
                        envelope: {
                            attack: 0.01,
                            decay: 0.1,
                            sustain: 0.3,
                            release: 0.1
                        },
                        volume: -15
                    }).toDestination();
                    
                    // Create a simple 8-bit style melody
                    const notes = ["C4", "E4", "G4", "C5", "G4", "E4", "A4", "F4", "G4", "C4"];
                    const durations = ["8n", "8n", "8n", "4n", "8n", "8n", "4n", "8n", "8n", "4n"];
                    
                    backgroundMusic = new Tone.Sequence((time, i) => {
                        synth.triggerAttackRelease(notes[i], durations[i], time);
                    }, [...Array(notes.length).keys()], "4n");
                    
                    Tone.Transport.bpm.value = 120;
                    
                    if (gameSettings.musicEnabled) {
                        Tone.Transport.start();
                        backgroundMusic.start(0);
                    }

                } catch (e) {
                    console.error("Error setting up enhanced audio:", e);
                    coinSynth = levelUpSynth = walkSynth = ambientSynth = backgroundMusic = null;
                }
            }

            function playCoinSound() {
                if (coinSynth && gameSettings.soundEnabled) {
                    // Super Mario style coin sound
                    coinSynth.triggerAttackRelease("B5", "16n");
                    coinSynth.triggerAttackRelease("E6", "8n", Tone.now() + 0.05);
                }
            }

            function playLevelUpSound() {
                if (levelUpSynth && gameSettings.soundEnabled) {
                    // Epic level up fanfare
                    const now = Tone.now();
                    levelUpSynth.triggerAttackRelease(["C4", "E4", "G4"], "4n", now);
                    levelUpSynth.triggerAttackRelease(["D4", "F#4", "A4"], "4n", now + 0.2);
                    levelUpSynth.triggerAttackRelease(["E4", "G#4", "B4"], "4n", now + 0.4);
                    levelUpSynth.triggerAttackRelease(["C5", "E5", "G5"], "2n", now + 0.6);
                }
            }

            function playWalkSound() {
                if (walkSynth && gameSettings.soundEnabled) {
                    walkSynth.triggerAttack();
                    setTimeout(() => walkSynth.triggerRelease(), 50);
                }
            }
            
            // Sound toggle functions
            window.toggleSound = function() {
                gameSettings.soundEnabled = !gameSettings.soundEnabled;
                soundToggle.classList.toggle('active');
                soundToggle.querySelector('.sound-icon').textContent = gameSettings.soundEnabled ? '' : '';
            }
            
            window.toggleMusic = function() {
                gameSettings.musicEnabled = !gameSettings.musicEnabled;
                musicToggle.classList.toggle('active');
                
                if (backgroundMusic) {
                    if (gameSettings.musicEnabled) {
                        Tone.Transport.start();
                        backgroundMusic.start(0);
                    } else {
                        backgroundMusic.stop();
                    }
                }
            }
            
            // Sprite change function
            window.changeSprite = function(spriteType) {
                player.selectedSprite = spriteType;
                
                // Update character sprite if not currently moving
                if (!isMoving) {
                    updateCharacterSprite(spriteType);
                }
                
                // Update selected sprite in UI
                document.querySelectorAll('.sprite-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                const spriteOptions = {
                    'sprite1': '.sprite-1',
                    'sprite2': '.sprite-2',
                    'sprite3': '.sprite-3',
                    'sprite4': '.sprite-4'
                };
                
                document.querySelector(spriteOptions[spriteType]).classList.add('selected');
            }

            // --- Enhanced Utility Functions ---
            function getRandomPosition(elementWidth, elementHeight) {
                const gameWorldWidth = gameWorld.offsetWidth;
                const gameWorldHeight = gameWorld.offsetHeight;
                
                if (!gameWorldWidth || !gameWorldHeight) {
                    return {
                        left: Math.random() * 200 + 100,
                        bottom: Math.random() * 200 + 120
                    };
                }
                
                const minX = 80;
                const maxX = gameWorldWidth - elementWidth - 80;
                const minY = 140;
                const maxY = gameWorldHeight - elementHeight - 140;

                const x = Math.random() * (maxX - minX) + minX;
                const y = Math.random() * (maxY - minY) + minY;

                return {
                    left: x,
                    bottom: gameWorldHeight - y - elementHeight
                };
            }

            function showFloatingText(x, y, text, color = '#ffff00') {
                const floatingText = document.createElement('div');
                floatingText.classList.add('floating-text');
                floatingText.textContent = text;
                floatingText.style.left = `${x}px`;
                floatingText.style.bottom = `${y + 50}px`;
                floatingText.style.color = color;
                gameWorld.appendChild(floatingText);
                
                setTimeout(() => floatingText.remove(), 2000);
            }

            function showNotification(message, type = 'level-up') {
                levelUpNotification.textContent = message;
                levelUpNotification.className = `level-up-notification ${type}`;
                levelUpNotification.style.display = 'block';
                setTimeout(() => {
                    levelUpNotification.style.display = 'none';
                }, 3000);
            }

            function getNextAchievementMessage() {
                lastAchievementIndex = (lastAchievementIndex + 1) % achievementMessages.length;
                return achievementMessages[lastAchievementIndex];
            }

            // --- Enhanced Character Movement ---
            function moveCharacterTo(targetX, targetY, callback) {
                if (isMoving) return;
                
                isMoving = true;
                
                // Start walking animation
                startWalkingAnimation();
                
                // Play walking sound
                const walkInterval = setInterval(playWalkSound, 200);
                
                // Calculate direction (flip character if moving left)
                const movingLeft = targetX < player.position.x;
                if (movingLeft) {
                    characterElement.style.transform = 'scaleX(-1)';
                } else {
                    characterElement.style.transform = 'scaleX(1)';
                }
                
                characterElement.classList.add('moving');
                characterElement.style.left = `${targetX}px`;
                characterElement.style.bottom = `${targetY}px`;
                
                player.position.x = targetX;
                player.position.y = targetY;
                
                setTimeout(() => {
                    clearInterval(walkInterval);
                    stopWalkingAnimation();
                    characterElement.classList.remove('moving');
                    updateCharacterSprite(player.selectedSprite);
                    isMoving = false;
                    if (callback) callback();
                }, gameSettings.characterSpeed * 1000);
            }
            
            // Mario-like walking animation
            function startWalkingAnimation() {
                // Clear any existing animation
                if (walkAnimationInterval) {
                    clearInterval(walkAnimationInterval);
                }
                
                // Start with sprite2 (walking sprite)
                updateCharacterSprite('sprite2');
                
                // Alternate between walking sprites for animation
                walkAnimationInterval = setInterval(() => {
                    walkAnimationFrame = walkAnimationFrame === 1 ? 2 : 1;
                    updateCharacterSprite(walkAnimationFrame === 1 ? 'sprite2' : 'sprite5');
                }, 150); // Change sprite every 150ms for a good walking animation speed
            }
            
            function stopWalkingAnimation() {
                if (walkAnimationInterval) {
                    clearInterval(walkAnimationInterval);
                    walkAnimationInterval = null;
                }
            }

            // --- Enhanced Character Sprite Management ---
            function updateCharacterSprite(state) {
                characterElement.classList.remove('sprite1', 'sprite2', 'sprite3', 'sprite4', 'sprite5', 'sprite6', 'sprite7', 'sprite8', 'sprite9', 'walking', 'level-up');
                characterElement.classList.add(state);
            }

            // --- Enhanced Game Logic Functions ---
            function updateHUD() {
                levelDisplay.textContent = player.level;
                coinsCollectedDisplay.textContent = player.xp;
                totalCoinsCollectedDisplay.textContent = player.totalCoinsCollected;
                totalCoinsCollectedStat.textContent = player.totalCoinsCollected;
                xpToNextLevelDisplay.textContent = gameSettings.xpLevels[player.level + 1] || 'MAX';
                
                const currentLevelXPThreshold = gameSettings.xpLevels[player.level];
                const nextLevelXPThreshold = gameSettings.xpLevels[player.level + 1];

                let xpProgress = 0;
                if (nextLevelXPThreshold) {
                    xpProgress = ((player.xp - currentLevelXPThreshold) / (nextLevelXPThreshold - currentLevelXPThreshold)) * 100;
                } else {
                    xpProgress = 100;
                }
                xpFill.style.width = `${Math.min(100, xpProgress)}%`;

                viewedRegionsStat.textContent = player.viewedRegions.size;
                currentLevelStat.textContent = player.level;
                totalRegionsStat.textContent = Object.keys(regionsData).length;
            }

            // Platform creation function
            function createPlatform() {
                const platforms = document.querySelectorAll('.platform');
                if (platforms.length >= gameSettings.maxPlatforms) return;
                
                const platform = document.createElement('div');
                platform.classList.add('platform');
                
                // Random width between 100 and 200px
                const width = Math.floor(Math.random() * 100) + 100;
                platform.style.width = `${width}px`;
                
                // Random position
                const position = getRandomPosition(width, 20);
                platform.style.left = `${position.left}px`;
                platform.style.bottom = `${position.bottom + 30}px`; // Slightly above ground level
                
                // Some platforms move
                if (Math.random() > 0.5) {
                    platform.classList.add('moving');
                    platform.style.animation = `platformMove ${Math.floor(Math.random() * 5) + 5}s infinite alternate linear`;
                }
                
                gameWorld.appendChild(platform);
                
                // Remove platform after some time
                setTimeout(() => {
                    platform.style.opacity = '0';
                    setTimeout(() => platform.remove(), 1000);
                }, 30000); // Platform lasts for 30 seconds
            }
            
            // Obstacle creation function
            function createObstacle() {
                const obstacles = document.querySelectorAll('.obstacle');
                if (obstacles.length >= gameSettings.maxObstacles) return;
                
                const obstacle = document.createElement('div');
                obstacle.classList.add('obstacle');
                
                const position = getRandomPosition(30, 30);
                obstacle.style.left = `${position.left}px`;
                obstacle.style.bottom = `${position.bottom}px`;
                
                gameWorld.appendChild(obstacle);
                
                // Remove obstacle after some time
                setTimeout(() => {
                    obstacle.style.opacity = '0';
                    setTimeout(() => obstacle.remove(), 1000);
                }, 20000); // Obstacle lasts for 20 seconds
            }
            
            // Power-up creation function
            function createPowerUp() {
                const powerUps = document.querySelectorAll('.power-up');
                if (powerUps.length >= gameSettings.maxPowerUps) return;
                
                const powerUp = document.createElement('div');
                powerUp.classList.add('power-up');
                
                // Random power-up type
                const types = ['speed', 'jump', 'shield'];
                const type = types[Math.floor(Math.random() * types.length)];
                powerUp.classList.add(type);
                powerUp.dataset.type = type;
                
                const position = getRandomPosition(25, 25);
                powerUp.style.left = `${position.left}px`;
                powerUp.style.bottom = `${position.bottom + 50}px`; // Higher up
                
                // Click handler for power-up collection
                powerUp.addEventListener('click', () => {
                    if (!isMoving) {
                        const powerUpX = parseInt(powerUp.style.left);
                        const powerUpY = parseInt(powerUp.style.bottom);
                        moveCharacterTo(powerUpX, powerUpY, () => collectPowerUp(powerUp));
                    }
                });
                
                gameWorld.appendChild(powerUp);
                
                // Remove power-up after some time
                setTimeout(() => {
                    powerUp.style.opacity = '0';
                    setTimeout(() => powerUp.remove(), 1000);
                }, 15000); // Power-up lasts for 15 seconds
            }
            
            // Power-up collection function
            function collectPowerUp(powerUp) {
                const type = powerUp.dataset.type;
                
                // Apply power-up effect
                switch (type) {
                    case 'speed':
                        gameSettings.characterSpeed = 0.3; // Faster movement
                        setTimeout(() => {
                            gameSettings.characterSpeed = 0.5; // Reset after 10 seconds
                        }, 10000);
                        showNotification(' Speed Boost Activated!');
                        break;
                    case 'jump':
                        gameSettings.jumpPower = 18; // Higher jumps
                        setTimeout(() => {
                            gameSettings.jumpPower = 12; // Reset after 10 seconds
                        }, 10000);
                        showNotification(' Super Jump Activated!');
                        break;
                    case 'shield':
                        // Add shield effect
                        characterElement.style.boxShadow = '0 0 20px rgba(255, 255, 0, 0.8)';
                        setTimeout(() => {
                            characterElement.style.boxShadow = ''; // Reset after 10 seconds
                        }, 10000);
                        showNotification(' Shield Activated!');
                        break;
                }
                
                // Play power-up sound
                if (levelUpSynth && gameSettings.soundEnabled) {
                    levelUpSynth.triggerAttackRelease(["C5", "E5", "G5"], "8n");
                }
                
                // Remove power-up
                powerUp.remove();
                
                // Add XP
                player.xp += 500;
                updateHUD();
                checkLevelUp();
                
                // Show floating text
                const powerUpRect = powerUp.getBoundingClientRect();
                const gameWorldRect = gameWorld.getBoundingClientRect();
                const relativeX = powerUpRect.left - gameWorldRect.left;
                const relativeY = gameWorldRect.bottom - powerUpRect.bottom;
                
                showFloatingText(relativeX, relativeY, '+500 XP!', '#00ffff');
                
                // Spawn new power-up after some time
                setTimeout(createPowerUp, 15000);
            }
            
            // Character jump function
            function jumpCharacter() {
                if (isMoving || isJumping) return;
                
                isJumping = true;
                characterElement.classList.add('jumping');
                
                // Play jump sound
                if (walkSynth && gameSettings.soundEnabled) {
                    walkSynth.triggerAttackRelease("G4", "16n");
                }
                
                setTimeout(() => {
                    characterElement.classList.remove('jumping');
                    isJumping = false;
                }, 500);
            }
            
            // Create platforms for Mario-style jumping
            function createPlatform() {
                const platforms = document.querySelectorAll('.platform');
                if (platforms.length >= gameSettings.maxPlatforms) return;
                
                const platform = document.createElement('div');
                platform.classList.add('platform');
                
                // Random width between 100-200px
                const width = Math.floor(Math.random() * 100) + 100;
                platform.style.width = `${width}px`;
                
                // Random position
                const position = getRandomPosition(width, 20);
                platform.style.left = `${position.left}px`;
                platform.style.bottom = `${position.bottom + 30}px`; // Slightly above ground level
                
                // Add moving class to some platforms
                if (Math.random() > 0.5) {
                    platform.classList.add('moving');
                }
                
                gameWorld.appendChild(platform);
                
                // Remove platform after some time
                setTimeout(() => {
                    platform.remove();
                    createPlatform();
                }, 15000);
            }
            
            // Create obstacles
            function createObstacle() {
                const obstacles = document.querySelectorAll('.obstacle');
                if (obstacles.length >= gameSettings.maxObstacles) return;
                
                const obstacle = document.createElement('div');
                obstacle.classList.add('obstacle');
                
                const position = getRandomPosition(30, 30);
                obstacle.style.left = `${position.left}px`;
                obstacle.style.bottom = `${position.bottom}px`;
                
                gameWorld.appendChild(obstacle);
                
                // Remove obstacle after some time
                setTimeout(() => {
                    obstacle.remove();
                    createObstacle();
                }, 10000);
            }
            
            // Create power-ups
            function createPowerUp() {
                const powerUps = document.querySelectorAll('.power-up');
                if (powerUps.length >= gameSettings.maxPowerUps) return;
                
                const powerUp = document.createElement('div');
                powerUp.classList.add('power-up');
                
                // Random power-up type
                const types = ['speed', 'jump', 'shield'];
                const type = types[Math.floor(Math.random() * types.length)];
                powerUp.classList.add(type);
                powerUp.dataset.type = type;
                
                const position = getRandomPosition(25, 25);
                powerUp.style.left = `${position.left}px`;
                powerUp.style.bottom = `${position.bottom + 50}px`; // Higher up
                
                // Click handler for power-up collection
                powerUp.addEventListener('click', () => {
                    if (!isMoving) {
                        const powerUpX = parseInt(powerUp.style.left);
                        const powerUpY = parseInt(powerUp.style.bottom);
                        moveCharacterTo(powerUpX, powerUpY, () => collectPowerUp(powerUp));
                    }
                });
                
                gameWorld.appendChild(powerUp);
                
                // Remove power-up after some time
                setTimeout(() => {
                    powerUp.remove();
                    createPowerUp();
                }, 12000);
            }
            
            // Collect power-up
            function collectPowerUp(powerUpElement) {
                const type = powerUpElement.dataset.type;
                
                // Apply power-up effect
                player.powerUps[type] = true;
                
                // Show floating text
                const powerUpRect = powerUpElement.getBoundingClientRect();
                const gameWorldRect = gameWorld.getBoundingClientRect();
                const relativeX = powerUpRect.left - gameWorldRect.left;
                const relativeY = gameWorldRect.bottom - powerUpRect.bottom;
                
                let effectText = '';
                let effectColor = '';
                
                switch(type) {
                    case 'speed':
                        effectText = 'SPEED BOOST!';
                        effectColor = '#00ccff';
                        // Apply speed effect
                        gameSettings.characterSpeed = 0.3; // Faster movement
                        setTimeout(() => {
                            gameSettings.characterSpeed = 0.5; // Reset after 10 seconds
                            player.powerUps.speed = false;
                        }, 10000);
                        break;
                    case 'jump':
                        effectText = 'SUPER JUMP!';
                        effectColor = '#ff00ff';
                        // Apply jump effect
                        gameSettings.jumpPower = 18; // Higher jumps
                        setTimeout(() => {
                            gameSettings.jumpPower = 12; // Reset after 10 seconds
                            player.powerUps.jump = false;
                        }, 10000);
                        break;
                    case 'shield':
                        effectText = 'SHIELD ACTIVE!';
                        effectColor = '#ffcc00';
                        // Apply shield effect
                        characterElement.style.boxShadow = '0 0 20px rgba(255, 204, 0, 0.7)';
                        setTimeout(() => {
                            characterElement.style.boxShadow = '';
                            player.powerUps.shield = false;
                        }, 10000);
                        break;
                }
                
                showFloatingText(relativeX, relativeY, effectText, effectColor);
                
                // Play power-up sound
                if (levelUpSynth && gameSettings.soundEnabled) {
                    levelUpSynth.triggerAttackRelease(["C5", "E5", "G5"], "8n");
                }
                
                // Remove power-up
                powerUpElement.remove();
                
                // Create new power-up after delay
                setTimeout(createPowerUp, 5000);
            }
            
            // Character jump function
            function jump() {
                if (player.isJumping) return;
                
                player.isJumping = true;
                player.jumpVelocity = gameSettings.jumpPower;
                
                // Add jumping class for animation
                characterElement.classList.add('jumping');
                
                // Play jump sound
                if (walkSynth && gameSettings.soundEnabled) {
                    walkSynth.triggerAttackRelease("G4", "16n");
                }
                
                // Apply gravity
                const jumpInterval = setInterval(() => {
                    // Update position
                    player.position.y += player.jumpVelocity;
                    player.jumpVelocity -= gameSettings.gravity;
                    
                    // Update character position
                    characterElement.style.bottom = `${player.position.y}px`;
                    
                    // Check if landed
                    if (player.position.y <= 95 && player.jumpVelocity < 0) {
                        player.position.y = 95;
                        characterElement.style.bottom = '95px';
                        player.isJumping = false;
                        player.jumpVelocity = 0;
                        clearInterval(jumpInterval);
                        characterElement.classList.remove('jumping');
                        
                        // Play landing sound
                        if (walkSynth && gameSettings.soundEnabled) {
                            walkSynth.triggerAttackRelease("C3", "16n");
                        }
                    }
                    
                    // Check for platform collision
                    checkPlatformCollision();
                    
                }, 30);
            }
            
            // Check for platform collision
            function checkPlatformCollision() {
                if (!player.isJumping || player.jumpVelocity >= 0) return;
                
                const characterRect = characterElement.getBoundingClientRect();
                
                document.querySelectorAll('.platform').forEach(platform => {
                    const platformRect = platform.getBoundingClientRect();
                    
                    // Check if character is above platform and falling onto it
                    if (characterRect.bottom <= platformRect.top + 10 && 
                        characterRect.bottom >= platformRect.top - 10 &&
                        characterRect.right > platformRect.left &&
                        characterRect.left < platformRect.right) {
                        
                        // Land on platform
                        player.position.y = (gameWorld.getBoundingClientRect().bottom - platformRect.top) + characterRect.height;
                        characterElement.style.bottom = `${player.position.y}px`;
                        player.jumpVelocity = 0;
                        
                        // Increment platforms jumped counter
                        player.platformsJumped++;
                        
                        // Check achievements
                        checkAchievements();
                        
                        // Play landing sound
                        if (walkSynth && gameSettings.soundEnabled) {
                            walkSynth.triggerAttackRelease("E3", "16n");
                        }
                    }
                });
            }
            
            function createXPCoin() {
                if (xpCoins.length >= gameSettings.maxCoins) return;

                const coin = document.createElement('div');
                coin.classList.add('xp-coin');
                const position = getRandomPosition(28, 28);
                
                coin.style.left = `${position.left}px`;
                coin.style.bottom = `${position.bottom}px`;
                coin.dataset.value = gameSettings.xpPerCoin;

                // Click handler for coin collection
                coin.addEventListener('click', () => {
                    if (!isMoving) {
                        const coinX = parseInt(coin.style.left) - 10;
                        const coinY = parseInt(coin.style.bottom) - 5;
                        moveCharacterTo(coinX, coinY, () => collectXPCoin(coin));
                    }
                });

                gameWorld.appendChild(coin);
                xpCoins.push(coin);
            }

            function collectXPCoin(coinElement) {
                playCoinSound();

                // Show floating XP text
                const coinRect = coinElement.getBoundingClientRect();
                const gameWorldRect = gameWorld.getBoundingClientRect();
                const relativeX = coinRect.left - gameWorldRect.left;
                const relativeY = gameWorldRect.bottom - coinRect.bottom;
                
                showFloatingText(relativeX, relativeY, `+${coinElement.dataset.value} XP!`, '#ffd700');

                coinElement.classList.add('collected');

                const index = xpCoins.indexOf(coinElement);
                if (index > -1) {
                    xpCoins.splice(index, 1);
                }

                setTimeout(() => coinElement.remove(), 1000);

                player.xp += parseInt(coinElement.dataset.value);
                player.totalCoinsCollected++;
                updateHUD();

                showNotification(getNextAchievementMessage(), 'achievement');
                checkLevelUp();
                
                setTimeout(createXPCoin, gameSettings.coinSpawnInterval);
            }

            function checkLevelUp() {
                const nextLevelXP = gameSettings.xpLevels[player.level + 1];
                if (nextLevelXP && player.xp >= nextLevelXP) {
                    player.level++;
                    updateHUD();
                    levelUp();
                } else if (!nextLevelXP && player.level < Object.keys(gameSettings.xpLevels).length) {
                    const maxLevel = Object.keys(gameSettings.xpLevels).length;
                    const maxLevelXPThreshold = gameSettings.xpLevels[maxLevel];
                    if (player.xp >= maxLevelXPThreshold && player.level < maxLevel) {
                         player.level = maxLevel;
                         updateHUD();
                         levelUp();
                    }
                }
            }

            function levelUp() {
                playLevelUpSound();
                leveledUpToDisplay.textContent = `LVL ${player.level} DATA SCIENTIST`;
                showNotification(` LEVEL UP! LVL ${player.level} `);
                updateCharacterSprite('level-up');
                
                // Show level up floating text
                showFloatingText(player.position.x, player.position.y, `LEVEL ${player.level}!`, '#ffff00');
                
                const maxLevel = Object.keys(gameSettings.xpLevels).length;
                if (player.level === maxLevel) {
                    appendMessage('bot', ` LEGENDARY! You've reached MAX LEVEL ${maxLevel} and unlocked Lakshay's ULTIMATE DATA SCIENTIST FORM! `);
                    showNotification(' ULTIMATE FORM UNLOCKED! ');
                    
                    // Change to energy sprite for max level
                    setTimeout(() => {
                        player.selectedSprite = 'sprite4';
                        updateCharacterSprite('sprite4');
                        
                        // Update selected sprite in UI
                        document.querySelectorAll('.sprite-option').forEach(option => {
                            option.classList.remove('selected');
                        });
                        document.querySelector('.sprite-4').classList.add('selected');
                    }, 2500);
                } else {
                    setTimeout(() => updateCharacterSprite(player.selectedSprite), 2500);
                }
            }

            // --- Enhanced World Map Functions ---
            window.openWorldMap = function() {
                worldMapModal.style.display = 'flex';
                loadRegions();
            }

            window.closeWorldMap = function() {
                worldMapModal.style.display = 'none';
            }

            function loadRegions() {
                regionsGrid.innerHTML = '';
                for (const key in regionsData) {
                    const region = regionsData[key];
                    const regionElement = document.createElement('div');
                    regionElement.classList.add('region');
                    regionElement.dataset.region = key;
                    if (player.viewedRegions.has(key)) {
                        regionElement.classList.add('viewed');
                    }
                    regionElement.innerHTML = `
                        <div class="region-icon">${region.icon}</div>
                        <div class="region-title">${region.title}</div>
                        <div class="region-description">${region.description}</div>
                    `;
                    regionElement.addEventListener('click', () => viewRegion(key));
                    regionsGrid.appendChild(regionElement);
                }
            }

            function viewRegion(regionName) {
                if (!player.viewedRegions.has(regionName)) {
                    player.viewedRegions.add(regionName);
                    updateHUD();
                    appendMessage('bot', ` Accessing ${regionsData[regionName].title}! Data successfully unlocked and added to your knowledge base.`);
                    const regionElement = document.querySelector(`.region[data-region="${regionName}"]`);
                    if (regionElement) {
                        regionElement.classList.add('viewed');
                    }
                } else {
                    appendMessage('bot', ` You've already mastered the ${regionsData[regionName].title}. All data has been absorbed!`);
                }
            }

            // --- Enhanced Chatbot Functions ---
            window.toggleChatbot = function() {
                chatbot.classList.toggle('minimized');
                chatbotToggleIcon.textContent = chatbot.classList.contains('minimized') ? '+' : '_';
                if (!chatbot.classList.contains('minimized')) {
                    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                }
            }

            window.sendMessage = async function() {
                const messageText = chatInput.value.trim();
                if (messageText === '') return;

                appendMessage('user', messageText);
                chatInput.value = '';

                // Enhanced AI responses with more personality
                let botResponse = " Processing your epic query through the data matrix...";

                const lowerMessage = messageText.toLowerCase();
                
                if (lowerMessage.includes('level') || lowerMessage.includes('xp')) {
                    botResponse = ` Current Status: Level ${player.level} Data Scientist! You have ${player.xp} XP and need ${gameSettings.xpLevels[player.level + 1] ? gameSettings.xpLevels[player.level + 1] - player.xp : 'MAX LEVEL ACHIEVED'} more XP to advance. You've collected ${player.totalCoinsCollected} coins so far! `;
                } else if (lowerMessage.includes('skills') || lowerMessage.includes('tech') || lowerMessage.includes('python')) {
                    botResponse = " Lakshay's skill arsenal is legendary! Python mastery with ML/DL frameworks like TensorFlow, Scikit-Learn, and advanced data visualization tools. His weapon of choice: statistical modeling and predictive analytics! Check the SKILL ARSENAL in INFO MAP for the complete inventory! ";
                } else if (lowerMessage.includes('experience') || lowerMessage.includes('internship') || lowerMessage.includes('work')) {
                    botResponse = " Epic work experience achieved! Data Science Intern at Prodigy InfoTech with 92% ML model accuracy, plus open-source contributions to Askage AI chatbot. Also coordinated massive French Embassy events! Quest for more details: INFO MAP  EXPERIENCE ZONE! ";
                } else if (lowerMessage.includes('projects') || lowerMessage.includes('spam') || lowerMessage.includes('fraud')) {
                    botResponse = " Legendary projects completed! SMS Spam Classifier with 97% accuracy and 100% precision, plus a Fraud Detection Model analyzing 6.2M+ transactions with 99.95% accuracy! Both deployed with Streamlit for real-time AI power! Full quest details in INFO MAP! ";
                } else if (lowerMessage.includes('contact') || lowerMessage.includes('phone') || lowerMessage.includes('email') || lowerMessage.includes('linkedin')) {
                    botResponse = " Ready to connect? All contact portals are available in the PROFILE HUB region! Direct teleportation links for LinkedIn, GitHub, email, and portfolio included. The adventure continues beyond this game! ";
                } else if (lowerMessage.includes('reset') || lowerMessage.includes('restart')) {
                    botResponse = " Want to restart your adventure? Use the RESET button in the action panel to begin a new journey through Lakshay's data universe! ";
                } else if (lowerMessage.includes('education') || lowerMessage.includes('university') || lowerMessage.includes('college')) {
                    botResponse = " Currently leveling up at University of Delhi with Bachelor of Commerce (Hons)! Mastering advanced mathematics, business statistics, and data science applications. The academic quest continues until 2026/27! ";
                } else if (lowerMessage.includes('sound') || lowerMessage.includes('audio') || lowerMessage.includes('music')) {
                    botResponse = " Sound controls activated! Toggle sound effects with the speaker button and background music with the music note button at the bottom left of your screen. Enhance your adventure with epic audio! ";
                } else if (lowerMessage.includes('sprite') || lowerMessage.includes('character') || lowerMessage.includes('avatar')) {
                    botResponse = " Character customization unlocked! Choose your preferred sprite from the selector at the bottom of the screen. Each sprite has unique visual effects - try the energy sprite for an epic glow effect! ";
                } else if (lowerMessage.includes('how') && lowerMessage.includes('play')) {
                    botResponse = " Game Controls: Click on coins to collect them! Your character will move to the coin and collect it. Change your sprite appearance using the selector at the bottom. Toggle sound effects and music with the buttons at the bottom left. Open the info map to learn more about Lakshay's skills and experience! ";
                } else {
                    const responses = [
                        " Interesting query! Try asking about Lakshay's epic level, legendary skills, heroic experience, or magnificent projects!",
                        " Data processing complete! Ask me about specific regions like skills, projects, or experience for detailed intel!",
                        " Quest unclear! Try commands like 'tell me about skills', 'what projects', or 'contact info' for epic responses!",
                        " Ready to assist! Ask about Lakshay's journey through the realms of data science, machine learning, or his legendary achievements!"
                    ];
                    botResponse = responses[Math.floor(Math.random() * responses.length)];
                }
                
                // Simulate realistic typing delay
                setTimeout(() => {
                    appendMessage('bot', botResponse);
                }, 800 + Math.random() * 1200);
            }

            function appendMessage(sender, text) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message', `${sender}-message`);
                messageDiv.innerHTML = text;
                chatbotMessages.appendChild(messageDiv);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }

            // --- Reset Game Function ---
            window.resetGame = function() {
                // Reset player state
                player.level = 1;
                player.xp = 0;
                player.viewedRegions.clear();
                player.totalCoinsCollected = 0;
                player.position = { x: 60, y: 95 };
                player.selectedSprite = 'sprite1';
                
                // Reset character position and sprite
                characterElement.style.left = '60px';
                characterElement.style.bottom = '95px';
                characterElement.style.transform = 'scaleX(1)'; // Reset any flipping
                updateCharacterSprite('sprite1');
                
                // Clear all coins
                xpCoins.forEach(coin => coin.remove());
                xpCoins.length = 0;
                
                // Clear floating texts
                document.querySelectorAll('.floating-text').forEach(text => text.remove());
                
                // Reset viewed regions in modal
                document.querySelectorAll('.region.viewed').forEach(region => {
                    region.classList.remove('viewed');
                });
                
                // Reset sprite selector
                document.querySelectorAll('.sprite-option').forEach(option => {
                    option.classList.remove('selected');
                });
                document.querySelector('.sprite-1').classList.add('selected');
                
                updateHUD();
                appendMessage('bot', ' Game reset complete! Welcome back to the beginning of your data science adventure! ');
                
                // Restart coin spawning
                setTimeout(() => {
                    for (let i = 0; i < gameSettings.maxCoins; i++) {
                        createXPCoin();
                    }
                }, 1000);
            }

            // --- Enhanced Particle System ---
            function createParticle() {
                const existingParticles = document.querySelectorAll('.particle');
                if (existingParticles.length >= 60) return;
                
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                const size = Math.random() * 4 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random colors for variety
                const colors = ['#00ff88', '#00bfff', '#ffff00', '#ff6600'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                const startX = Math.random() * window.innerWidth;
                const animationDuration = Math.random() * 6 + 6;
                const delay = Math.random() * 10;

                particle.style.left = `${startX}px`;
                particle.style.animationDuration = `${animationDuration}s`;
                particle.style.animationDelay = `${delay}s`;

                document.getElementById('particleSystem').appendChild(particle);

                particle.addEventListener('animationend', () => {
                    particle.remove();
                    if (document.querySelectorAll('.particle').length < 40) {
                        createParticle();
                    }
                });
            }

            function initParticles(count = 40) {
                const existingParticles = document.querySelectorAll('.particle');
                existingParticles.forEach(p => p.remove());
                
                for (let i = 0; i < count; i++) {
                    setTimeout(() => createParticle(), i * 100);
                }
            }

            // --- Enhanced Game Initialization ---
            async function initializeGame() {
                // Set character to idle sprite initially
                updateCharacterSprite(player.selectedSprite);
                
                updateHUD();
                initParticles();
                
                try {
                    await setupAudio();
                } catch (error) {
                    console.warn('Enhanced audio initialization failed:', error);
                }

                loadRegions();

                chatInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        sendMessage();
                    }
                });
                
                window.addEventListener('beforeunload', cleanupGame);
                
                // Welcome message
                setTimeout(() => {
                    appendMessage('bot', ' Welcome to Lakshay\'s Data Science RPG! I\'m your AI guide. Click on coins to collect them and gain XP. Ask me anything! ');
                }, 1500);
                
                // Start the game world
                setTimeout(() => {
                    for (let i = 0; i < gameSettings.maxCoins; i++) {
                        setTimeout(() => createXPCoin(), i * 500);
                    }
                    
                    coinSpawnTimer = setInterval(() => {
                        if (xpCoins.length < gameSettings.maxCoins) {
                            createXPCoin();
                        }
                    }, gameSettings.coinSpawnInterval);
                }, 2000);
            }
            
            // --- Enhanced Cleanup Function ---
            function cleanupGame() {
                if (coinSpawnTimer) {
                    clearInterval(coinSpawnTimer);
                }
                
                if (walkAnimationInterval) {
                    clearInterval(walkAnimationInterval);
                }
                
                document.querySelectorAll('.particle').forEach(p => p.remove());
                document.querySelectorAll('.floating-text').forEach(text => text.remove());
                
                xpCoins.forEach(coin => coin.remove());
                xpCoins.length = 0;
                
                if (coinSynth) coinSynth.dispose();
                if (levelUpSynth) levelUpSynth.dispose();
                if (walkSynth) walkSynth.dispose();
                if (ambientSynth) ambientSynth.dispose();
                if (backgroundMusic) backgroundMusic.dispose();
            }

            // Day/Night Cycle Toggle
            function toggleDayNightCycle() {
                const body = document.body;
                const dayNightToggle = document.getElementById('dayNightToggle');
                
                if (body.classList.contains('day-mode')) {
                    // Switch to sunset mode
                    body.classList.remove('day-mode');
                    body.classList.add('sunset-mode');
                    dayNightToggle.classList.remove('day');
                    dayNightToggle.classList.add('sunset');
                } else if (body.classList.contains('sunset-mode')) {
                    // Switch to night mode (default)
                    body.classList.remove('sunset-mode');
                    dayNightToggle.classList.remove('sunset');
                } else {
                    // Switch to day mode
                    body.classList.add('day-mode');
                    dayNightToggle.classList.add('day');
                }
                
                // Play transition sound if available
                if (ambientSynth && gameSettings.soundEnabled) {
                    ambientSynth.triggerAttackRelease("C5", "16n");
                    ambientSynth.triggerAttackRelease("G5", "16n", Tone.now() + 0.1);
                }
            }
            
            // Mini-map Toggle
            function toggleMiniMap() {
                const miniMap = document.getElementById('miniMap');
                if (miniMap.style.display === 'none') {
                    miniMap.style.display = 'flex';
                } else {
                    miniMap.style.display = 'none';
                }
            }
            
            // Update Mini-map
            function updateMiniMap() {
                const miniMapContent = document.getElementById('miniMapContent');
                const miniMapPlayer = document.createElement('div');
                
                // Clear previous content
                miniMapContent.innerHTML = '';
                
                // Add player marker
                miniMapPlayer.className = 'mini-map-player';
                
                // Calculate relative position (percentage)
                const worldWidth = gameWorld.offsetWidth;
                const worldHeight = gameWorld.offsetHeight;
                const relativeX = (player.position.x / worldWidth) * 100;
                const relativeY = (player.position.y / worldHeight) * 100;
                
                miniMapPlayer.style.left = `${relativeX}%`;
                miniMapPlayer.style.top = `${100 - relativeY}%`; // Invert Y-axis
                
                miniMapContent.appendChild(miniMapPlayer);
                
                // Add coin markers
                xpCoins.forEach(coin => {
                    const coinRect = coin.getBoundingClientRect();
                    const gameWorldRect = gameWorld.getBoundingClientRect();
                    
                    const coinX = ((coinRect.left - gameWorldRect.left) / worldWidth) * 100;
                    const coinY = ((gameWorldRect.bottom - coinRect.bottom) / worldHeight) * 100;
                    
                    const miniMapCoin = document.createElement('div');
                    miniMapCoin.className = 'mini-map-coin';
                    miniMapCoin.style.left = `${coinX}%`;
                    miniMapCoin.style.top = `${coinY}%`;
                    
                    miniMapContent.appendChild(miniMapCoin);
                });
                
                // Add platform markers
                document.querySelectorAll('.platform').forEach(platform => {
                    const platformRect = platform.getBoundingClientRect();
                    const gameWorldRect = gameWorld.getBoundingClientRect();
                    
                    const platformX = ((platformRect.left - gameWorldRect.left) / worldWidth) * 100;
                    const platformY = ((gameWorldRect.bottom - platformRect.bottom) / worldHeight) * 100;
                    const platformWidth = (platformRect.width / worldWidth) * 100;
                    
                    const miniMapPlatform = document.createElement('div');
                    miniMapPlatform.className = 'mini-map-platform';
                    miniMapPlatform.style.left = `${platformX}%`;
                    miniMapPlatform.style.top = `${platformY}%`;
                    miniMapPlatform.style.width = `${platformWidth}%`;
                    
                    miniMapContent.appendChild(miniMapPlatform);
                });
                
                // Add obstacle markers
                document.querySelectorAll('.obstacle').forEach(obstacle => {
                    const obstacleRect = obstacle.getBoundingClientRect();
                    const gameWorldRect = gameWorld.getBoundingClientRect();
                    
                    const obstacleX = ((obstacleRect.left - gameWorldRect.left) / worldWidth) * 100;
                    const obstacleY = ((gameWorldRect.bottom - obstacleRect.bottom) / worldHeight) * 100;
                    
                    const miniMapObstacle = document.createElement('div');
                    miniMapObstacle.className = 'mini-map-obstacle';
                    miniMapObstacle.style.left = `${obstacleX}%`;
                    miniMapObstacle.style.top = `${obstacleY}%`;
                    
                    miniMapContent.appendChild(miniMapObstacle);
                });
                
                // Add power-up markers
                document.querySelectorAll('.power-up').forEach(powerUp => {
                    const powerUpRect = powerUp.getBoundingClientRect();
                    const gameWorldRect = gameWorld.getBoundingClientRect();
                    
                    const powerUpX = ((powerUpRect.left - gameWorldRect.left) / worldWidth) * 100;
                    const powerUpY = ((gameWorldRect.bottom - powerUpRect.bottom) / worldHeight) * 100;
                    
                    const miniMapPowerUp = document.createElement('div');
                    miniMapPowerUp.className = 'mini-map-power-up';
                    miniMapPowerUp.style.left = `${powerUpX}%`;
                    miniMapPowerUp.style.top = `${powerUpY}%`;
                    
                    miniMapContent.appendChild(miniMapPowerUp);
                });
            }
            
            // Achievement System
            const achievements = [
                {
                    id: 'coin_collector_1',
                    title: 'Coin Collector I',
                    description: 'Collect 5 coins',
                    icon: '',
                    rarity: 'common',
                    requirement: () => player.totalCoinsCollected >= 5,
                    reward: 500,
                    progress: () => Math.min(player.totalCoinsCollected / 5, 1),
                    unlocked: false
                },
                {
                    id: 'coin_collector_2',
                    title: 'Coin Collector II',
                    description: 'Collect 15 coins',
                    icon: '',
                    rarity: 'rare',
                    requirement: () => player.totalCoinsCollected >= 15,
                    reward: 1000,
                    progress: () => Math.min(player.totalCoinsCollected / 15, 1),
                    unlocked: false
                },
                {
                    id: 'explorer',
                    title: 'Explorer',
                    description: 'View all regions in the info map',
                    icon: '',
                    rarity: 'epic',
                    requirement: () => player.viewedRegions.size >= Object.keys(regionsData).length,
                    reward: 2000,
                    progress: () => Math.min(player.viewedRegions.size / Object.keys(regionsData).length, 1),
                    unlocked: false
                },
                {
                    id: 'master_data_scientist',
                    title: 'Master Data Scientist',
                    description: 'Reach level 5',
                    icon: '',
                    rarity: 'legendary',
                    requirement: () => player.level >= 5,
                    reward: 5000,
                    progress: () => Math.min(player.level / 5, 1),
                    unlocked: false
                }
            ];
            
            function checkAchievements() {
                let newAchievementUnlocked = false;
                
                achievements.forEach(achievement => {
                    if (!achievement.unlocked && achievement.requirement()) {
                        achievement.unlocked = true;
                        newAchievementUnlocked = true;
                        
                        // Add XP reward
                        player.xp += achievement.reward;
                        updateHUD();
                        checkLevelUp();
                        
                        // Show achievement popup
                        showAchievementPopup(achievement);
                    }
                });
                
                return newAchievementUnlocked;
            }
            
            function showAchievementPopup(achievement) {
                const popup = document.getElementById('achievementPopup');
                const description = document.getElementById('achievementPopupDescription');
                const reward = document.getElementById('achievementPopupReward');
                
                description.textContent = `${achievement.title}: ${achievement.description}`;
                reward.textContent = `Reward: +${achievement.reward} XP`;
                
                popup.style.display = 'block';
                
                // Play achievement sound
                if (levelUpSynth && gameSettings.soundEnabled) {
                    const now = Tone.now();
                    levelUpSynth.triggerAttackRelease(["C5", "E5", "G5"], "8n", now);
                    levelUpSynth.triggerAttackRelease(["D5", "F#5", "A5"], "8n", now + 0.2);
                    levelUpSynth.triggerAttackRelease(["E5", "G#5", "B5"], "8n", now + 0.4);
                }
                
                setTimeout(() => {
                    popup.style.display = 'none';
                }, 5000);
            }
            
            function openAchievementsModal() {
                const modal = document.getElementById('achievementsModal');
                const achievementsList = document.getElementById('achievementsList');
                
                // Clear previous content
                achievementsList.innerHTML = '';
                
                // Add achievements
                achievements.forEach(achievement => {
                    const badge = document.createElement('div');
                    badge.className = `achievement-badge ${achievement.rarity} ${achievement.unlocked ? '' : 'locked'}`;
                    
                    const icon = document.createElement('div');
                    icon.className = `achievement-icon ${achievement.rarity}`;
                    icon.textContent = achievement.icon;
                    
                    const details = document.createElement('div');
                    details.className = 'achievement-details';
                    
                    const title = document.createElement('div');
                    title.className = 'achievement-title';
                    title.textContent = achievement.title;
                    
                    const description = document.createElement('div');
                    description.className = 'achievement-description';
                    description.textContent = achievement.description;
                    
                    const progress = document.createElement('div');
                    progress.className = 'achievement-progress';
                    progress.textContent = achievement.unlocked ? 'Completed!' : 'In Progress';
                    
                    const progressBar = document.createElement('div');
                    progressBar.className = 'achievement-progress-bar';
                    
                    const progressFill = document.createElement('div');
                    progressFill.className = 'achievement-progress-fill';
                    progressFill.style.width = `${achievement.progress() * 100}%`;
                    
                    progressBar.appendChild(progressFill);
                    details.appendChild(title);
                    details.appendChild(description);
                    details.appendChild(progress);
                    details.appendChild(progressBar);
                    
                    badge.appendChild(icon);
                    badge.appendChild(details);
                    
                    achievementsList.appendChild(badge);
                });
                
                modal.style.display = 'flex';
            }
            
            function closeAchievementsModal() {
                const modal = document.getElementById('achievementsModal');
                modal.style.display = 'none';
            }
            
            // Global function attachments
            window.openWorldMap = openWorldMap;
            window.closeWorldMap = closeWorldMap;
            window.viewRegion = viewRegion;
            window.toggleChatbot = toggleChatbot;
            window.sendMessage = sendMessage;
            window.resetGame = resetGame;
            window.toggleDayNightCycle = toggleDayNightCycle;
            window.toggleMiniMap = toggleMiniMap;
            window.openAchievements = openAchievementsModal;
            window.closeAchievementsModal = closeAchievementsModal;

            // Initialize the enhanced game
            document.addEventListener('DOMContentLoaded', () => {
                initializeGame();
                
                // Add keyboard controls for movement and jumping
                document.addEventListener('keydown', function(event) {
                    if (isMoving || player.isJumping) return; // Don't allow movement while already moving or jumping
                    
                    const step = 50; // Movement step size
                    let newX = player.position.x;
                    
                    switch (event.key) {
                        case 'ArrowLeft':
                        case 'a':
                        case 'A':
                            newX -= step;
                            characterElement.style.transform = 'scaleX(-1)'; // Flip character left
                            break;
                        case 'ArrowRight':
                        case 'd':
                        case 'D':
                            newX += step;
                            characterElement.style.transform = 'scaleX(1)'; // Face character right
                            break;
                        case 'ArrowUp':
                        case 'w':
                        case 'W':
                        case ' ': // Spacebar
                            jump();
                            return;
                    }
                    
                    // Check boundaries
                    const gameWorldRect = gameWorld.getBoundingClientRect();
                    if (newX < 0) newX = 0;
                    if (newX > gameWorldRect.width - 40) newX = gameWorldRect.width - 40;
                    
                    // Move character if position changed
                    if (newX !== player.position.x) {
                        moveCharacterTo(newX, player.position.y);
                    }
                });
                
                // Create initial platforms, obstacles and power-ups
                for (let i = 0; i < gameSettings.maxPlatforms; i++) {
                    setTimeout(() => createPlatform(), i * 1000);
                }
                
                setTimeout(() => createObstacle(), 5000);
                setTimeout(() => createPowerUp(), 10000);
                
                // Update mini-map periodically
                setInterval(updateMiniMap, 1000);
                
                // Check achievements periodically
                setInterval(checkAchievements, 5000);
            });
        })();
    </script>
</body>
</html>
